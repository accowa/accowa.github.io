
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>NEMOSIM - Cook book (5) &#8212; nemosim 1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NEMOSIM - Cook book (6)" href="nscookbook6.html" />
    <link rel="prev" title="NEMOSIM - Cook book (4)" href="nscookbook4.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_images/NEMO-Website.png" border="0" alt="nemosim"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="nscookbook6.html" title="NEMOSIM - Cook book (6)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nscookbook4.html" title="NEMOSIM - Cook book (4)"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NEMOSIM - Cook book (5)</a><ul>
<li><a class="reference internal" href="#limited-area-views-and-models">Limited area views and models</a></li>
<li><a class="reference internal" href="#limited-area-views-from-global-datasets">1. Limited area views from global datasets</a></li>
<li><a class="reference internal" href="#producing-images-from-regional-datasets">2. Producing images from regional datasets</a></li>
<li><a class="reference internal" href="#cropping-by-reducing-the-regional-box">3. Cropping by reducing the regional box</a></li>
<li><a class="reference internal" href="#using-the-orthogonal-projection">4   Using the orthogonal projection</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nscookbook4.html"
                        title="previous chapter">NEMOSIM - Cook book (4)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nscookbook6.html"
                        title="next chapter">NEMOSIM - Cook book (6)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/nscookbook5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nemosim-cook-book-5">
<span id="nscookbook5"></span><h1>NEMOSIM - Cook book (5)<a class="headerlink" href="#nemosim-cook-book-5" title="Permalink to this headline">¶</a></h1>
<div class="section" id="limited-area-views-and-models">
<h2>Limited area views and models<a class="headerlink" href="#limited-area-views-and-models" title="Permalink to this headline">¶</a></h2>
<p>The examples so far have concentrated on producing images of or from global model
datasets. This section demonstrates some of the options for producing limited area views;
either from global datasets or from regional model output.</p>
</div>
<div class="section" id="limited-area-views-from-global-datasets">
<h2>1. Limited area views from global datasets<a class="headerlink" href="#limited-area-views-from-global-datasets" title="Permalink to this headline">¶</a></h2>
<p>Producing a limited area view from a larger dataset has been demonstrated previously by
employing the pan and zoom options of the orthogonal projection. However, a similar result
can also be achieved with the default, uniform long-lat projection by specifying the
bounding coordinates of the region of interest. These bounds are supplied as longitude
latitude pairs to the <code class="docutils literal notranslate"><span class="pre">-sw</span></code> and <code class="docutils literal notranslate"><span class="pre">-ne</span></code> options. As the names suggest, these options
specify the lower left (<code class="docutils literal notranslate"><span class="pre">-sw</span></code>) corners and upper right (<code class="docutils literal notranslate"><span class="pre">-ne</span></code>) corners of the bounding
rectangle in long-lat space. Because <code class="docutils literal notranslate"><span class="pre">nemosim</span></code> was originally developed with global
models in mind, an additional option: <code class="docutils literal notranslate"><span class="pre">-no_offset</span></code> may be required to disable some
assumptions about the longitudinal cyclicity of the data. For example, an attempt to
produce a regional view of the bathymetry around the Kerguelen plateau (i.e. a similar
view to the earlier orthogonal example) such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="n">f</span> <span class="n">data</span><span class="o">/</span><span class="n">bathy_level</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">d</span> <span class="n">Bathy_level</span> <span class="o">-</span><span class="n">o</span> <span class="n">example14a</span><span class="o">.</span><span class="n">png</span> \
          <span class="o">-</span><span class="n">sw</span> <span class="mf">60.</span> <span class="o">-</span><span class="mf">55.</span> <span class="o">-</span><span class="n">ne</span> <span class="mf">79.</span> <span class="o">-</span><span class="mf">44.5</span> <span class="o">-</span><span class="n">nomask</span> <span class="o">-</span><span class="n">show</span>
</pre></div>
</div>
<p>doesn’t quite produce the expected result:</p>
<a class="reference internal image-reference" href="_images/example14a.png"><img alt="_images/example14a.png" class="align-center" src="_images/example14a.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>Adding the <code class="docutils literal notranslate"><span class="pre">-no_offset</span></code> option fixes this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example14a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example14b</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">no_offset</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example14b.png"><img alt="_images/example14b.png" class="align-center" src="_images/example14b.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>Note regions that straddle the Greenwich Meridion  can be produced from suitable sources
by specifying <code class="docutils literal notranslate"><span class="pre">-ne</span></code> longitude values greater than 360.</p>
</div>
<div class="section" id="producing-images-from-regional-datasets">
<h2>2. Producing images from regional datasets<a class="headerlink" href="#producing-images-from-regional-datasets" title="Permalink to this headline">¶</a></h2>
<p>NEMO is often used for regional studies and, with care, <code class="docutils literal notranslate"><span class="pre">nemosim</span></code> can be used to produce
images from regional model output. To demonstrate this some example data is provided from
the Atlantic Margin Model at 1 minute resolution (AMM60). The data provided are for a
single SST field which is sufficient to demonstrate the capabilities. Bear in mind,
though, that <code class="docutils literal notranslate"><span class="pre">nemosim</span></code> merely extracts a slice through the depth dimension for plotting.
Since many regional models are run with sigma-style vertical coordinates, it may be
necessary to introduce a preprocessing step if the intention is to plot a constant depth
surface away from the sea surface.</p>
<p>Firstly, try the default settings with the new data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="n">f</span> <span class="n">data</span><span class="o">/</span><span class="n">AMM60_sst</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">d</span> <span class="n">sst</span> <span class="o">-</span><span class="n">o</span> <span class="n">example15a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">show</span> <span class="o">-</span><span class="n">nomask</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example15a.png"><img alt="_images/example15a.png" class="align-center" src="_images/example15a.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>which does little more than demonstrate the default assumptions for global data. The
plotted patch can be moved around by repositioning the central longitude line. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example15a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example15b</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">cenl</span> <span class="mf">90.</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example15b.png"><img alt="_images/example15b.png" class="align-center" src="_images/example15b.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>but to reduce the blank areas we need to specify the bounding region. Suitable values can
be obtained by scanning the nav_lon and nav_lat fields in the dataset. This almost works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example15a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example15c</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">sw</span> <span class="mf">335.</span> <span class="mf">39.5</span> <span class="o">-</span><span class="n">ne</span> <span class="mf">377.5</span> <span class="mf">65.5</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example15c.png"><img alt="_images/example15c.png" class="align-center" src="_images/example15c.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>but suffers from the cyclic assumptions (check the top left-hand corner). Note that by
setting the bounding region, <code class="docutils literal notranslate"><span class="pre">nemosim</span></code> has entered a non-global mode where points
outside the data domain are set to the alternative background colour (default gray). This
reveals the shape of the data domain with curvilinear boundaries in the uniform long-lat
projection. Adding the <code class="docutils literal notranslate"><span class="pre">-no_offset</span></code> option produces the first clear and complete result
from the regional model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example15c</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example15d</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">no_offset</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example15d.png"><img alt="_images/example15d.png" class="align-center" src="_images/example15d.png" style="width: 180.0px; height: 100.0px;" /></a>
<p>Finally, changing the aspect ratio produces a more natural result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example15d</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example15e</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">r</span> <span class="mi">700</span> <span class="mi">600</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example15e.png"><img alt="_images/example15e.png" class="align-center" src="_images/example15e.png" style="width: 175.0px; height: 150.0px;" /></a>
</div>
<div class="section" id="cropping-by-reducing-the-regional-box">
<h2>3. Cropping by reducing the regional box<a class="headerlink" href="#cropping-by-reducing-the-regional-box" title="Permalink to this headline">¶</a></h2>
<p>When producing images for purposes such as animation sequences, it is desirable to have
images with straighter edges. One simple way the achieve this is to set a bounding region
wholly contained within the data domain, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="n">f</span> <span class="n">data</span><span class="o">/</span><span class="n">AMM60_sst</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">d</span> <span class="n">sst</span> <span class="o">-</span><span class="n">o</span> <span class="n">example16</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">show</span> \
       <span class="o">-</span><span class="n">nomask</span> <span class="o">-</span><span class="n">sw</span> <span class="mf">343.35</span> <span class="mf">41.00</span> <span class="o">-</span><span class="n">ne</span> <span class="mf">367.</span> <span class="mf">63.45</span> <span class="o">-</span><span class="n">r</span> <span class="mi">452</span> <span class="mi">600</span> \
       <span class="o">-</span><span class="n">no_offset</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example16.png"><img alt="_images/example16.png" class="align-center" src="_images/example16.png" style="width: 113.0px; height: 150.0px;" /></a>
<p>which has the desired effect but, of course, truncates some of the domain.</p>
</div>
<div class="section" id="using-the-orthogonal-projection">
<h2>4   Using the orthogonal projection<a class="headerlink" href="#using-the-orthogonal-projection" title="Permalink to this headline">¶</a></h2>
<p>There is a better alternative because, in the case of the AMM60 domain, the area appears
nearly rectangular when viewed using the orthogonal projection. This may not be
immediately apparent so it is useful to document the steps taken from the default setting
to reach the final view. Firstly, acitivate the orthogonal projection in a square image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="n">f</span> <span class="n">data</span><span class="o">/</span><span class="n">AMM60_sst</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">d</span> <span class="n">sst</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">nomask</span> \
       <span class="o">-</span><span class="n">r</span> <span class="mi">600</span> <span class="mi">600</span> <span class="o">-</span><span class="n">ortho</span> <span class="o">-</span><span class="n">show</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17a.png"><img alt="_images/example17a.png" class="align-center" src="_images/example17a.png" style="width: 150.0px; height: 150.0px;" /></a>
<p>Now centre the image on the centre of the data domain using the first two Euler angles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example17a</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17b</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">eu1</span> <span class="mf">356.</span> <span class="o">-</span><span class="n">eu2</span> <span class="mf">53.</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17b.png"><img alt="_images/example17b.png" class="align-center" src="_images/example17b.png" style="width: 150.0px; height: 150.0px;" /></a>
<p>Next use the vmask option to set the land points (which have the value 0.0) to gray:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example17b</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17c</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">vmask</span> <span class="mf">100.</span> <span class="mf">0.0</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17c.png"><img alt="_images/example17c.png" class="align-center" src="_images/example17c.png" style="width: 150.0px; height: 150.0px;" /></a>
<p>Now use the zoom option (<code class="docutils literal notranslate"><span class="pre">-gsize</span></code>) to almost fill the image area with the data domain.
Because of the shape of the data domain, the best result is obtained with a slightly
rectangular canvas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example17c</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17d</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">r</span> <span class="mi">600</span> <span class="mi">720</span> <span class="o">-</span><span class="n">gsize</span> <span class="mi">30</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17d.png"><img alt="_images/example17d.png" class="align-center" src="_images/example17d.png" style="width: 150.0px; height: 180.0px;" /></a>
<p>At this stage it is obvious that a slight twist around the third axis will give a more
even border around the data domain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example17d</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17e</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">eu3</span> <span class="o">-</span><span class="mf">1.</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17e.png"><img alt="_images/example17e.png" class="align-center" src="_images/example17e.png" style="width: 150.0px; height: 180.0px;" /></a>
<p>With these settings as a basis we can add the dressing and by exercising fine control over
font sizes and placements produce a complete image suitable for animation purposes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nemosim</span> <span class="o">-</span><span class="k">as</span> <span class="n">example17e</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">o</span> <span class="n">example17f</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">spos</span> <span class="mi">2</span> <span class="o">-</span><span class="n">bbg</span> <span class="n">black</span> \
       <span class="o">-</span><span class="n">bfg</span> <span class="n">white</span> <span class="o">-</span><span class="n">stfs</span> <span class="mi">14</span> <span class="o">-</span><span class="n">sfs</span> <span class="mi">11</span> <span class="o">-</span><span class="n">margins</span> <span class="mi">10</span> <span class="mi">96</span> <span class="mi">30</span> <span class="mi">30</span> \
       <span class="o">-</span><span class="n">grid</span> <span class="mi">5</span> <span class="mi">5</span> <span class="o">-</span><span class="n">limits</span> <span class="mi">0</span>   <span class="o">.</span><span class="mi">0</span> <span class="mf">18.0</span> <span class="o">-</span><span class="n">cs</span> <span class="n">blue2red_b</span><span class="o">.</span><span class="n">pal</span> \
       <span class="o">-</span><span class="n">title</span> <span class="s2">&quot;AMM60 Sea Surface Temperature&quot;</span> <span class="o">-</span><span class="n">stitle</span> <span class="n">C</span> \
       <span class="o">-</span><span class="n">stjus</span> <span class="mi">7</span> <span class="o">-</span><span class="n">stpos</span> <span class="mi">612</span> <span class="mi">750</span> \
       <span class="o">-</span><span class="n">logo</span>    <span class="o">./</span><span class="n">data</span><span class="o">/</span><span class="n">NOC_logo_white</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">lsize</span> <span class="mi">120</span> <span class="mi">60</span> \
       <span class="o">-</span><span class="n">lpos</span> <span class="mi">4</span> <span class="mi">6</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span> <span class="o">-</span><span class="n">dateclk</span> <span class="mi">60</span> <span class="mi">468</span> <span class="mi">600</span> <span class="mi">18102012</span> <span class="o">-</span><span class="n">tfs</span> <span class="mi">24</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example17f.png"><img alt="_images/example17f.png" class="align-center" src="_images/example17f.png" style="width: 176.5px; height: 195.0px;" /></a>
<p>The next section of the cookbook will use this last example as the basis for an animation
sequence which demonstrates many of the advantages of nemosim.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="nscookbook6.html" title="NEMOSIM - Cook book (6)"
             >next</a> |</li>
        <li class="right" >
          <a href="nscookbook4.html" title="NEMOSIM - Cook book (4)"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Andrew C. Coward, National Oceanography Centre, UK.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>