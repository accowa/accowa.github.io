<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>NEMOSIM - Cook book (4) &mdash; nemosim 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="nemosim 1.0 documentation" href="index.html" />
    <link rel="next" title="NEMOSIM - Cook book (5)" href="nscookbook5.html" />
    <link rel="prev" title="NEMOSIM - Cook book (3)" href="nscookbook3.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_images/NEMO-Website.png" border="0" alt="nemosim"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="nscookbook5.html" title="NEMOSIM - Cook book (5)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nscookbook3.html" title="NEMOSIM - Cook book (3)"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NEMOSIM - Cook book (4)</a><ul>
<li><a class="reference internal" href="#controlling-the-layout">Controlling the layout</a></li>
<li><a class="reference internal" href="#overview-of-options-used">1. Overview of options used</a></li>
<li><a class="reference internal" href="#determining-current-settings">2. Determining current settings</a></li>
<li><a class="reference internal" href="#matching-settings-to-command-line-options">3. Matching settings to command-line options</a></li>
<li><a class="reference internal" href="#setting-margins">4. Setting margins</a></li>
<li><a class="reference internal" href="#using-scale-margins-to-control-colourbars">5. Using scale margins to control colourbars</a></li>
<li><a class="reference internal" href="#label-placement-and-text-justification">6. Label placement and text justification</a></li>
<li><a class="reference internal" href="#text-fonts">7. Text fonts</a></li>
<li><a class="reference internal" href="#logo-placement-and-sizing">8. Logo placement and sizing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nscookbook3.html"
                        title="previous chapter">NEMOSIM - Cook book (3)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nscookbook5.html"
                        title="next chapter">NEMOSIM - Cook book (5)</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/nscookbook4.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="nemosim-cook-book-4">
<span id="nscookbook4"></span><h1>NEMOSIM - Cook book (4)<a class="headerlink" href="#nemosim-cook-book-4" title="Permalink to this headline">¶</a></h1>
<div class="section" id="controlling-the-layout">
<h2>Controlling the layout<a class="headerlink" href="#controlling-the-layout" title="Permalink to this headline">¶</a></h2>
<p>Most of the examples so far have relied on the default settings for many of the layout
parameters.  The results are reasonable but there is scope for refining images further by
exercising control over settings such as:</p>
<ul class="simple">
<li>Individual margin widths and heights</li>
<li>Position and width of colourbars</li>
<li>Position, size and font of text labels and titles</li>
<li>Inclusion, placement and size of optional logo image</li>
<li>Inclusion, placement and size of optional date-clock</li>
</ul>
<p>This chapter is dedicated to explaining the layout controls and how to alter their settings.
The explanation will be based on an examination of this image and its variants:</p>
<a class="reference internal image-reference" href="_images/example12a.png"><img alt="_images/example12a.png" class="align-center" src="_images/example12a.png" style="width: 580.0px; height: 396.0px;" /></a>
<p>which was produced by this command:</p>
<div class="highlight-python"><div class="highlight"><pre>./nemosim -f ./data/ORCA025_2001m01I.nc -o example12a.png -d isstempe -r 880 640 \
          -nomask -show -spos 1 -stitle SST -title &quot;Sea Surface Temperature with sea ice&quot; \
          -d2 ileadfra -limits2 0.0 0.8 -overlay -bbg #a6a6a6 -stitle2 &quot;ice conc.&quot; \
          -logo ./data/NOC_logo.png -lsize 158 50 -lpos 5 5 -tfnt &quot;Handwriting---Dakota&quot;
</pre></div>
</div>
<p>Several new elements have been introduced here so that the finer control over their
appearance and placement can be discussed. The next section briefly describes the new
elements.</p>
</div>
<div class="section" id="overview-of-options-used">
<h2>1. Overview of options used<a class="headerlink" href="#overview-of-options-used" title="Permalink to this headline">¶</a></h2>
<p>This example has:</p>
<ul class="simple">
<li>Set explicit titles for each colourbar (<tt class="docutils literal"><span class="pre">-stitle</span></tt> and <tt class="docutils literal"><span class="pre">-stitle2</span></tt> respectively)</li>
<li>Set an explicit plot title (<tt class="docutils literal"><span class="pre">-title</span></tt>)</li>
<li>Set border background colour to a mid-gray (<tt class="docutils literal"><span class="pre">-bbg</span></tt>)</li>
<li>Requested the inclusion of a logo image (<tt class="docutils literal"><span class="pre">-logo</span></tt>)</li>
<li>Set and explicit size for the logo (<tt class="docutils literal"><span class="pre">-lsize</span></tt>)</li>
<li>Positioned the logo explicitly (<tt class="docutils literal"><span class="pre">-lpos</span></tt>)</li>
<li>Requested a particular font for the plot title (<tt class="docutils literal"><span class="pre">-tfnt</span></tt>)</li>
</ul>
<p>Note that string arguments containing spaces or dashes must be quoted. The fonts available
can be listed using the <cite>ImageMagick</cite> <tt class="docutils literal"><span class="pre">identify</span></tt> utility. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>identify -list font | grep Font | grep -v glyphs
</pre></div>
</div>
<p>should produce an uncluttered list. The aspect ratio of the logo will be preserved so the
resultant logo size will be determined by the limiting dimension. In this case the logo
source image is: 511x113 so the requested size of 158x50 will provide a 158x35 pixel-sized
image.</p>
<p>Apart from the logo placement, there are no explicit layout instructions given. To
understand how the default layout is determined it is necessary to review the internal
data structures, how the program variables relate to the layout and how default values
are computed.</p>
</div>
<div class="section" id="determining-current-settings">
<h2>2. Determining current settings<a class="headerlink" href="#determining-current-settings" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">-info</span></tt> option can be used to display the key internal data structures. For the
current exercise only the first section (relating to the image control structure) of the
output written to standard out is relevant:</p>
<div class="highlight-python"><div class="highlight"><pre>./nemosim -as example12a.png -info


=====================================================================================
== Details of internal image control structure (im of type canvas):                ==
==         warning: long strings may be truncated to 48 characters                 ==
=====================================================================================
           wi  =                     pixel width  main drawing area    880
           ht  =                     pixel height main drawing area    640
           bl  =            pixel width  of additional left  margin    140
           br  =            pixel width  of additional right margin    140
           bb  =            pixel height of additional base  margin     76
           bt  =            pixel height of additional top   margin     76
           sbl =                 pixel width  of scale left  margin     28
           sbr =                 pixel width  of scale right margin     98
           sbb =                 pixel height of scale base  margin     76
           sbt =                 pixel height of scale top   margin    228
          spos =  scale position, may not match input if overlaying      2
          tfs  =                           title font size (points)     30
          tpx  =                             title x-pixel position    580
          tpy  =                             title y-pixel position     19
          tjs  =                               title justification       8
          stfs =                     scale title font size (points)     14
     stpx(1:2) =                       scale title x-pixel position    140  1020
     stpy(1:2) =                       scale title y-pixel position    716   716
     stjs(1:2) =                                scale title justif.      7     9
           sfs =                scale annotation font size (points)     12
       trnspbg =    logical switch (0/1) for transparent background      0
       trnspfg =    logical switch (0/1) for transparent background      0
       show    =    logical switch (0/1) to display the final image      1
      imgtype =                 output image type 1=jpeg, other=png      0
       logosx= =                               optional logo x-size    158
        logosy =                               optional logo y-size     50
        logox  =                           optional logo x-position      5
        logoy  =                           optional logo y-position      5
           day =                        optional day (part of date)      1
         month =                      optional month (part of date)      4
          year =                       optional year (part of date)   1958
          drad =                optional pixel radius of date clock    100
         dposx =      optional pixel xposition of date clock centre    100
         dposy =      optional pixel yposition of date clock centre    100
         annox =             optional pixel xposition of annotation     15
         annoy =             optional pixel yposition of annotation     15
         annfs =                      optional annotation font-size     11
  fn(MAX_STR)  =                              image output filename: example12a.png
  csn(MAX_STR) =                      colour scale palette filename: ./pals/pastel2.pal
 ocsn(MAX_STR) =              overlay colour scale palette filename: ./pals/seaice.pal
   bg(MAX_STR) =                                  background colour: black
   fg(MAX_STR) =                                  foreground colour: white
  abg(MAX_STR) =                      alternative background colour: #9A9A9A
  bbg(MAX_STR) =                           border background colour: #a6a6a6
  bfg(MAX_STR) =                           border foreground colour: black
 ttxt(MAX_STR) =                                         title text: Sea Surface Temperature with sea ice
 stxt(MAX_STR) =                                   scale title text: SST
stxt2(MAX_STR) =                   scale title text for overlay var: ice conc.
 tfnt(MAX_STR) =                                         title font: Handwriting---Dakota
 sfnt(MAX_STR) =                                         scale font: Arial
stfnt(MAX_STR) =                                   scale title font: Arial
 logo(MAX_STR) =                                    logo image file: ./data/NOC_logo.png
annot(MAX_STR) =                                    annotation text:
</pre></div>
</div>
<p>This list contains settings which obviously correspond to values supplied on the command
line (e.g. <tt class="docutils literal"><span class="pre">tfnt</span></tt>, <tt class="docutils literal"><span class="pre">wi</span></tt>, <tt class="docutils literal"><span class="pre">ht</span></tt> etc.) but also contains many other values with less
obvious correspondence and/or default values. Before reviewing the correspondence between
known and yet to be introduced command line options and the entries in this data structure
it is useful to have a pictorial representation of some of the layout variables:</p>
<a class="reference internal image-reference" href="_images/example12b.png"><img alt="_images/example12b.png" class="align-center" src="_images/example12b.png" style="width: 1024.0px; height: 727.0px;" /></a>
<p>This diagram shows how the various layout variables are used to construct the image.
Default values are set as fixed percentages of the main image size (<tt class="docutils literal"><span class="pre">wi</span></tt> x <tt class="docutils literal"><span class="pre">ht</span></tt>) which
are the arguments given to the <tt class="docutils literal"><span class="pre">-r</span></tt> option. The values given to border widths and
heights depend on the selected position for the colourbar. If no colourbar is requested
(<tt class="docutils literal"><span class="pre">-spos</span> <span class="pre">0</span></tt> then the default behaviour is to disable all borders. The following table
lists the default settings:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="21%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">spos</th>
<th class="head">colourbar</th>
<th class="head">bl</th>
<th class="head">br</th>
<th class="head">bb</th>
<th class="head">bt</th>
<th class="head">sbl</th>
<th class="head">sbr</th>
<th class="head">sbb</th>
<th class="head">sbt</th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head">position</th>
<th class="head">(%wi)</th>
<th class="head">(%wi)</th>
<th class="head">(%ht)</th>
<th class="head">(%ht)</th>
<th class="head">(%bl)</th>
<th class="head">(%br)</th>
<th class="head">(%bb)</th>
<th class="head">(%bt)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>none</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="row-even"><td>1 or 2</td>
<td>left or right</td>
<td>16</td>
<td>16</td>
<td>12</td>
<td>12</td>
<td>20</td>
<td>70</td>
<td>100</td>
<td>300</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>top</td>
<td>16</td>
<td>16</td>
<td>12</td>
<td>12</td>
<td>300</td>
<td>100</td>
<td>70</td>
<td>20</td>
</tr>
<tr class="row-even"><td>4</td>
<td>bottom</td>
<td>16</td>
<td>16</td>
<td>12</td>
<td>12</td>
<td>100</td>
<td>350</td>
<td>70</td>
<td>20</td>
</tr>
<tr class="row-odd"><td>5 or 7</td>
<td>lhs arc-scale</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>10</td>
<td>30</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="row-even"><td>6 or 8</td>
<td>rhs arc-scale</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>10</td>
<td>30</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Note also that the default positioning of titles and scale labels will also depend on the
image size and choice of scale position. Of the various text font sizes, only the title
text is scaled with image size; and only if the text height would otherwise exceed the
border height. It is therefore always possible to request an image size or aspect ratio
for which the default settings are inappropriate. For these cases, explicit control over
all the layout variables is provided via the command-line options. The next section lists
the options and the corresponding internal variables that they set. For brevity some
options set multiple variables so it may be necessary to supply default values (as given
by the <tt class="docutils literal"><span class="pre">-info</span></tt> option) for those components you wish the leave unchanged. See the
&#8216;Setting margins&#8217; section for an example of this.</p>
</div>
<div class="section" id="matching-settings-to-command-line-options">
<h2>3. Matching settings to command-line options<a class="headerlink" href="#matching-settings-to-command-line-options" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="36%" />
<col width="30%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Cmd line option</th>
<th class="head">arguments</th>
<th class="head">description</th>
<th class="head">variables set</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-r</td>
<td>width height</td>
<td>image dimensions in pixels</td>
<td>wi ht</td>
</tr>
<tr class="row-odd"><td>-margins</td>
<td>left right bottom top</td>
<td>margin sizes in pixels</td>
<td>bl  br  bb  bt</td>
</tr>
<tr class="row-even"><td>-Margins</td>
<td>left% right% bottom% top%</td>
<td>margin sizes as percentages</td>
<td>bl  br  bb  bt</td>
</tr>
<tr class="row-odd"><td>-smargins</td>
<td>left right bottom top</td>
<td>margin sizes in pixels</td>
<td>sbl sbr sbb sbt</td>
</tr>
<tr class="row-even"><td>-Smargins</td>
<td>left% right% bottom% top%</td>
<td>margin sizes as percentages</td>
<td>sbl sbr sbb sbt</td>
</tr>
<tr class="row-odd"><td>-title</td>
<td>title_text</td>
<td>title text</td>
<td>ttxt</td>
</tr>
<tr class="row-even"><td>-tpos</td>
<td>title_xpos title_ypos</td>
<td>title position</td>
<td>tpx tpy</td>
</tr>
<tr class="row-odd"><td>-tjus</td>
<td>title_text_justification</td>
<td>title justification</td>
<td>tjs</td>
</tr>
<tr class="row-even"><td>-tfnt</td>
<td>title_font</td>
<td>title font</td>
<td>tfnt</td>
</tr>
<tr class="row-odd"><td>-tfs</td>
<td>title_font_pointsize</td>
<td>title font-size (points)</td>
<td>tfs</td>
</tr>
<tr class="row-even"><td>-stitle</td>
<td>scale_title_text</td>
<td>scale title text</td>
<td>stxt</td>
</tr>
<tr class="row-odd"><td>-stpos</td>
<td>scale_title_xpos scale_title_ypos</td>
<td>scale title position</td>
<td>stpx(1) stpy(1)</td>
</tr>
<tr class="row-even"><td>-stjus</td>
<td>scale_title_text_justification</td>
<td>scale title justification</td>
<td>stjs(1)</td>
</tr>
<tr class="row-odd"><td>-stitle2</td>
<td>2nd_scale_title_text</td>
<td>2nd scale title text</td>
<td>stxt2</td>
</tr>
<tr class="row-even"><td>-stpos2</td>
<td>2nd_scale_title_x 2nd_scale_title_y</td>
<td>2nd scale title position</td>
<td>stpx(2) stpy(2)</td>
</tr>
<tr class="row-odd"><td>-stjus2</td>
<td>2nd_scale_title_text_justification</td>
<td>2nd scale title justification</td>
<td>stjs(2)</td>
</tr>
<tr class="row-even"><td>-stfnt</td>
<td>scale_title_font</td>
<td>scale title font</td>
<td>stfnt</td>
</tr>
<tr class="row-odd"><td>-stfs</td>
<td>title_font_pointsize</td>
<td>scale title font-size (points)</td>
<td>stfs</td>
</tr>
<tr class="row-even"><td>-sfnt</td>
<td>scale_font</td>
<td>scale number font</td>
<td>sfnt</td>
</tr>
<tr class="row-odd"><td>-sfs</td>
<td>scale_font_pointsize</td>
<td>scale number font-size</td>
<td>sfs</td>
</tr>
<tr class="row-even"><td>-logo</td>
<td>logo_image_file</td>
<td>logo image file</td>
<td>logo</td>
</tr>
<tr class="row-odd"><td>-lsize</td>
<td>logo_width logo_height</td>
<td>logo size limits</td>
<td>logosx logosy</td>
</tr>
<tr class="row-even"><td>-lpos</td>
<td>logo_xpos logo_ypos</td>
<td>logo position (top-left)</td>
<td>logox logoy</td>
</tr>
<tr class="row-odd"><td>-annotate</td>
<td>xpos ypos label_text</td>
<td>optional extra annotation</td>
<td>annox annoy annot</td>
</tr>
<tr class="row-even"><td>-afs</td>
<td>annotation-font-size</td>
<td>extra annotation font-size</td>
<td>annfs</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="setting-margins">
<h2>4. Setting margins<a class="headerlink" href="#setting-margins" title="Permalink to this headline">¶</a></h2>
<p>The previous sections have shown how the image layout is controlled by various parameters,
how to query what the default or current settings are for these parameters and finally how
the available commad-line options relate to these parameters. Armed with this information,
it is now possible to take control over the layout and refine images according to need or
personal taste.</p>
<p>As a first example, consider a desire to reduce the external white space around the image
whilst retaining all other relative sizes and positions. The obvious approach is to use
either the <tt class="docutils literal"><span class="pre">-margins</span></tt> (absolute pixel values) or <tt class="docutils literal"><span class="pre">-Margins</span></tt> (% of image dimensions)
option to set new border sizes. This will work in the bottom border case where all the
default settings based on <tt class="docutils literal"><span class="pre">bb</span></tt> (<tt class="docutils literal"><span class="pre">sbb</span></tt>, <tt class="docutils literal"><span class="pre">stpx,</span> <span class="pre">stpy</span></tt>) will adjust correctly. The top
border can also be reduced safely so long as care is taken to leave sufficient height to
accommodate the logo height. However, changes to the side borders will change the
appearance of the colorbars unless compensating changes are made to the scale margins (via
<tt class="docutils literal"><span class="pre">-smargins</span></tt> or <tt class="docutils literal"><span class="pre">-Smargins</span></tt>). This is best demonstrated by a naive example to reduce
all margins ( remembering their default values in this case are equivalent to <tt class="docutils literal"><span class="pre">-margins</span>
<span class="pre">140</span> <span class="pre">140</span> <span class="pre">76</span> <span class="pre">76</span></tt> ):</p>
<div class="highlight-python"><div class="highlight"><pre>./nemosim -as example12a.png -o example12c.png -margins 80 80 42 42
</pre></div>
</div>
<p>To see the differences it is best to view this new image (left) alongside the orginal
(right):</p>
<a class="reference internal image-reference" href="_images/example12c.png"><img alt="_images/example12c.png" class="align-center" src="_images/example12c.png" style="width: 520.0px; height: 362.0px;" /></a>
<a class="reference internal image-reference" href="_images/example12a.png"><img alt="_images/example12a.png" class="align-center" src="_images/example12a.png" style="width: 580.0px; height: 396.0px;" /></a>
<p>Mostly, the required result has been achieved but note the thinning and stretching of the
colurbars and the slight vertical displacement of the title relative to the main image.</p>
</div>
<div class="section" id="using-scale-margins-to-control-colourbars">
<h2>5. Using scale margins to control colourbars<a class="headerlink" href="#using-scale-margins-to-control-colourbars" title="Permalink to this headline">¶</a></h2>
<p>The original colourbars can be restored by noting that the thickness and length of the
colourbar are given by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">width</span>  <span class="o">=</span> <span class="n">bl</span> <span class="o">-</span> <span class="n">sbr</span> <span class="o">-</span> <span class="n">sbl</span>
<span class="n">length</span> <span class="o">=</span> <span class="n">ht</span> <span class="o">+</span> <span class="n">bb</span> <span class="o">+</span> <span class="n">bt</span> <span class="o">-</span> <span class="n">sbt</span> <span class="o">-</span> <span class="n">sbb</span>
</pre></div>
</div>
<p>which, for the original image, compute as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">width</span>  <span class="o">=</span> <span class="mi">140</span> <span class="o">-</span> <span class="mi">28</span> <span class="o">-</span> <span class="mi">98</span>            <span class="o">=</span> <span class="mi">14</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">640</span> <span class="o">+</span> <span class="mi">76</span> <span class="o">+</span> <span class="mi">76</span> <span class="o">-</span> <span class="mi">76</span> <span class="o">-</span> <span class="mi">226</span> <span class="o">=</span> <span class="mi">490</span>
</pre></div>
</div>
<p>Thus these settings could be used to restore the original dimensions:</p>
<div class="highlight-python"><div class="highlight"><pre>./nemosim -as example12a.png -o example12d.png -margins 80 80 42 42 -smargins 14 52 42 192
</pre></div>
</div>
<p>since:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">width</span>  <span class="o">=</span> <span class="mi">80</span> <span class="o">-</span> <span class="mi">14</span> <span class="o">-</span> <span class="mi">52</span>             <span class="o">=</span> <span class="mi">14</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">640</span> <span class="o">+</span> <span class="mi">42</span> <span class="o">+</span> <span class="mi">42</span> <span class="o">-</span> <span class="mi">42</span> <span class="o">-</span> <span class="mi">192</span> <span class="o">=</span> <span class="mi">490</span>
</pre></div>
</div>
<p>Now compare this new image (left) alongside the orginal (right):</p>
<a class="reference internal image-reference" href="_images/example12d.png"><img alt="_images/example12d.png" class="align-center" src="_images/example12d.png" style="width: 520.0px; height: 362.0px;" /></a>
<a class="reference internal image-reference" href="_images/example12a.png"><img alt="_images/example12a.png" class="align-center" src="_images/example12a.png" style="width: 580.0px; height: 396.0px;" /></a>
<p>Of course it is rarely necessary to match these dimensions precisely but the capability is
there if required. Note similar calculations may be necessary if trying to match sizes for
horizontal colourscales. In these cases the relevant widths and lengths will be given by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">length</span>  <span class="o">=</span> <span class="n">wi</span> <span class="o">+</span> <span class="n">bl</span> <span class="o">+</span> <span class="n">br</span> <span class="o">-</span> <span class="n">sbl</span> <span class="o">-</span> <span class="n">sbr</span>
<span class="n">width</span>   <span class="o">=</span> <span class="n">bb</span> <span class="o">-</span> <span class="n">sbb</span> <span class="o">-</span> <span class="n">sbt</span>   <span class="ow">or</span>   <span class="n">bt</span> <span class="o">-</span> <span class="n">sbb</span> <span class="o">-</span> <span class="n">sbt</span>
</pre></div>
</div>
</div>
<div class="section" id="label-placement-and-text-justification">
<h2>6. Label placement and text justification<a class="headerlink" href="#label-placement-and-text-justification" title="Permalink to this headline">¶</a></h2>
<p>The default positions of the title and scale titles will depend on the choice of
colourscale position. The following table summarises the defaults. Note that all pixel
coordinates are measured from the top left corner with y positive downwards. Firstly for
the main title:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="23%" />
<col width="23%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">scale position</th>
<th class="head">main title x</th>
<th class="head">main title y</th>
<th class="head">justification</th>
</tr>
<tr class="row-even"><th class="head">(spos)</th>
<th class="head">tpx</th>
<th class="head">tpy</th>
<th class="head">tjs</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>1, 2, 3, 7 or 8</td>
<td>bl+0.5*wi</td>
<td>0.85*bt</td>
<td>2</td>
</tr>
<tr class="row-even"><td>4, 5, or 6</td>
<td>bl+0.5*wi</td>
<td>bt+ht+0.85*bb</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>and, secondly for the scale title. Note the second scale title (if present) will
automatically take values for the opposite margin to that of the first:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="23%" />
<col width="23%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">scale position</th>
<th class="head">scale title x</th>
<th class="head">scale title y</th>
<th class="head">justification</th>
</tr>
<tr class="row-even"><th class="head">(spos)</th>
<th class="head">stpx(:)</th>
<th class="head">stpy(:)</th>
<th class="head">stjs(:)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>1, 3 or 7</td>
<td>bl</td>
<td>ht+bt</td>
<td>7</td>
</tr>
<tr class="row-even"><td>5</td>
<td>bl</td>
<td>0.25*bt</td>
<td>7</td>
</tr>
<tr class="row-odd"><td>2 or 8</td>
<td>wi+bl</td>
<td>ht+bt</td>
<td>9</td>
</tr>
<tr class="row-even"><td>4 or 6</td>
<td>wi+bl</td>
<td>0.25*bt</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>The default label placements will not suit all uses but these values are easily
over-ridden using the <tt class="docutils literal"><span class="pre">-tpos</span></tt> and  <tt class="docutils literal"><span class="pre">-tjus</span></tt> options for the main title and the
<tt class="docutils literal"><span class="pre">-stpos</span></tt>, <tt class="docutils literal"><span class="pre">-stjus</span></tt> and <tt class="docutils literal"><span class="pre">-stpos2</span></tt>, <tt class="docutils literal"><span class="pre">-stjus2</span></tt> paired options for the scale titles.</p>
<p>Nine text justification options are provided as illustrated in this diagram:</p>
<a class="reference internal image-reference" href="_images/justification.png"><img alt="_images/justification.png" class="align-center" src="_images/justification.png" style="width: 667.2px; height: 124.8px;" /></a>
<p>where the blue dot represents a fixed <tt class="docutils literal"><span class="pre">-tpos</span></tt> coordinate with varying text justification
choices and the red rectangle shows the computed boundary text box.  Note that the use of
these justification points depends on the <cite>ImageMagick</cite> calculation of text fontmetrics
which provide a correctly sized bounding box for the text but not the box&#8217;s position.
Consequently, there is scope for slight misplacement as demonstrated in the example above
that does not bound the descending p correctly.  Generally, though the method is accurate
enough for an approximate placement that can be refined, if neccessary, within one
iteration.</p>
</div>
<div class="section" id="text-fonts">
<h2>7. Text fonts<a class="headerlink" href="#text-fonts" title="Permalink to this headline">¶</a></h2>
<p>Each <cite>ImageMagick</cite> installation will have access to a variety of fonts. The exact list
available will depend on the installation and may not even include all the fonts used in
this cookbook. The <cite>ImageMagick</cite> utilities can be used to obtain a list of the available
fonts:</p>
<div class="highlight-python"><div class="highlight"><pre>identify -list font | grep &#39;Font:&#39; | sed -e &#39;s/.*: //&#39; &gt; fontlist

cat fontlist
AvantGarde-Book
AvantGarde-BookOblique
AvantGarde-Demi
AvantGarde-DemiOblique
Bookman-Demi
Bookman-DemiItalic
Bookman-Light
Bookman-LightItalic
Courier-BoldOblique
.
.
Yuppy-SC-Regular
Yuppy-TC-Regular
Zapf-Dingbats
Zapfino
ヒラギノ丸ゴ-Pro-W4
ヒラギノ丸ゴ-ProN-W4
ヒラギノ角ゴ-StdN-W8
</pre></div>
</div>
<p>The list can be long and not particularly useful unless you are just looking to confirm
the presence of a known font. As an alternative, the <tt class="docutils literal"><span class="pre">bin/fontimg.sh</span></tt> script is provided
to supply a visual illustration of the available fonts. In its basic form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">fontimg</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>will create a fontlist listing (using the identify command above) and then will produce
one or more images (depending on the number of entries in fontlist) in which the entries
are numbered and listed using their own fonts. Subsequent invocations of fontimg.sh can be
made with numeric arguments corresponding to list positions. In these cases an enlarged
view of the listed fonts will be produced. This secondary usage can be used in a single
step to view known font families. For example, say you only wish to view the verdana fonts
available on your system, then:</p>
<div class="highlight-python"><div class="highlight"><pre>bin/fontimg.sh `grep -n -i verdana fontlist | sed -e&#39;s/:.*$//&#39;`
</pre></div>
</div>
<p>will produce a series of <tt class="docutils literal"><span class="pre">onefontNNN.png</span></tt> images such as these four:</p>
<a class="reference internal image-reference" href="_images/example13a.png"><img alt="_images/example13a.png" class="align-center" src="_images/example13a.png" style="width: 800.0px; height: 320.0px;" /></a>
<p>All the available fonts can be used for titles and scale labels by naming the required
font via the <tt class="docutils literal"><span class="pre">-tfnt</span></tt> (title font) <tt class="docutils literal"><span class="pre">-stfnt</span></tt> (scale title font) <tt class="docutils literal"><span class="pre">-sfnt</span></tt> (scale font)
options. In all cases the argument is the full string given in the fontlist listing. These
strings will most often need to be quoted due to the presence of hyphens. [TBD need
<tt class="docutils literal"><span class="pre">-afnt</span></tt> option to control annotation font too].</p>
</div>
<div class="section" id="logo-placement-and-sizing">
<h2>8. Logo placement and sizing<a class="headerlink" href="#logo-placement-and-sizing" title="Permalink to this headline">¶</a></h2>
<p>A facility is provided for an external image to be read and overlaid in any position on
the working canvas. This is intended for adding a single logo and works best with png
images using a transparent background.  The <cite>ImageMagick</cite> tool, <tt class="docutils literal"><span class="pre">composite</span></tt>, should be
used for more complex compositing of multiple images. The following three command-line
options and arguments determine the source image, size and placement:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">-logo</span> <span class="pre">logo_image_file</span></tt></li>
<li><tt class="docutils literal"><span class="pre">-lsize</span> <span class="pre">x_pixel_size</span> <span class="pre">y_pixel_size</span></tt></li>
<li><tt class="docutils literal"><span class="pre">-lpos</span> <span class="pre">x_pixel_position</span> <span class="pre">y_pixel_position</span></tt> (bottom left corner)</li>
</ul>
<p>The simple ratio scaling algorithm used will maintain the aspect ratio of the logo so the
resultant logo size may not be exactly that requested by the <tt class="docutils literal"><span class="pre">-lsize</span></tt> arguments. The
actual size will be determined by the limiting dimension. For example, if the logo source
image is 511x113, a  requested size of 158x50 will provide a 158x35 pixel-sized logo.
Whereas a requested size of 300x50 will provide a 226x50 pixel-sized logo.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="nscookbook5.html" title="NEMOSIM - Cook book (5)"
             >next</a> |</li>
        <li class="right" >
          <a href="nscookbook3.html" title="NEMOSIM - Cook book (3)"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Andrew C. Coward, National Oceanography Centre, UK.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>